<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KPCL Automation - Configuration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-robot me-2"></i>KPCL Automation
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">
                    <i class="fas fa-home"></i> Dashboard
                </a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <h2><i class="fas fa-cog me-2"></i>Configuration</h2>
                <p class="text-muted">Configure automation settings and form data</p>
            </div>
        </div>

        <div class="row">
            <!-- Application Settings -->
            <div class="col-md-6">
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Application Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="app-settings-form">
                            <div class="mb-3">
                                <label class="form-label">Schedule Time</label>
                                <input type="time" name="schedule_time" class="form-control" 
                                       value="{{ config.schedule_time[:-3] }}" step="1" required>
                                <small class="text-muted">Time when automation should run daily (24-hour format)</small>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Maximum Retries</label>
                                        <input type="number" name="max_retries" class="form-control" 
                                               value="{{ config.max_retries }}" min="1" max="10" required>
                                        <small class="text-muted">Number of retry attempts</small>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Retry Interval (seconds)</label>
                                        <input type="number" name="retry_interval" class="form-control" 
                                               value="{{ config.retry_interval }}" min="5" max="300" required>
                                        <small class="text-muted">Wait time between retries</small>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Browser</label>
                                <select name="browser" class="form-select">
                                    <option value="chrome" {% if config.browser == 'chrome' %}selected{% endif %}>Chrome</option>
                                    <option value="firefox" {% if config.browser == 'firefox' %}selected{% endif %}>Firefox</option>
                                </select>
                                <small class="text-muted">Browser to use for automation</small>
                            </div>

                            <div class="mb-3">
                                <div class="form-check">
                                    <input type="checkbox" name="headless" class="form-check-input" 
                                           {% if config.headless %}checked{% endif %}>
                                    <label class="form-check-label">Run in Headless Mode</label>
                                    <small class="text-muted d-block">Run browser without GUI (recommended for production)</small>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Save App Settings
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Form Data Settings -->
            <div class="col-md-6">
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="fas fa-file-alt me-2"></i>Form Data Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="form-data-form">
                            <div class="mb-3">
                                <label class="form-label">Purpose of Fly Ash Utilization</label>
                                <select name="ash_utilization" class="form-select" required>
                                    <option value="Ash_based_Products" {% if form_data.ash_utilization == 'Ash_based_Products' %}selected{% endif %}>
                                        Ash_based_Products
                                    </option>
                                    <option value="Construction" {% if form_data.ash_utilization == 'Construction' %}selected{% endif %}>
                                        Construction
                                    </option>
                                    <option value="Road_Construction" {% if form_data.ash_utilization == 'Road_Construction' %}selected{% endif %}>
                                        Road_Construction
                                    </option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Pickup Timing</label>
                                <select name="pickup_time" class="form-select" required>
                                    <option value="09.00AM - 10.00AM" {% if form_data.pickup_time == '09.00AM - 10.00AM' %}selected{% endif %}>
                                        09.00AM - 10.00AM
                                    </option>
                                    <option value="10.00AM - 11.00AM" {% if form_data.pickup_time == '10.00AM - 11.00AM' %}selected{% endif %}>
                                        10.00AM - 11.00AM
                                    </option>
                                    <option value="11.00AM - 12.00PM" {% if form_data.pickup_time == '11.00AM - 12.00PM' %}selected{% endif %}>
                                        11.00AM - 12.00PM
                                    </option>
                                    <option value="02.00PM - 03.00PM" {% if form_data.pickup_time == '02.00PM - 03.00PM' %}selected{% endif %}>
                                        02.00PM - 03.00PM
                                    </option>
                                    <option value="03.00PM - 04.00PM" {% if form_data.pickup_time == '03.00PM - 04.00PM' %}selected{% endif %}>
                                        03.00PM - 04.00PM
                                    </option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Type of Vehicle</label>
                                <input type="text" name="vehicle_type" class="form-control" 
                                       value="{{ form_data.vehicle_type }}" required>
                                <small class="text-muted">e.g., Bluker 16 Wheeler</small>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Quantity Limit</label>
                                        <input type="number" name="quantity_limit" class="form-control" 
                                               value="{{ form_data.quantity_limit }}" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Vehicle Classification</label>
                                        <select name="vehicle_classification" class="form-select" required>
                                            <option value="Hired" {% if form_data.vehicle_classification == 'Hired' %}selected{% endif %}>Hired</option>
                                            <option value="Own" {% if form_data.vehicle_classification == 'Own' %}selected{% endif %}>Own</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Authorized Person</label>
                                <input type="text" name="authorised_person" class="form-control" 
                                       value="{{ form_data.authorised_person }}" required>
                            </div>

                            <hr>
                            <h6 class="text-primary">Vehicle Details</h6>

                            <div class="mb-3">
                                <label class="form-label">Vehicle Number</label>
                                <input type="text" name="vehicle_no" class="form-control" 
                                       value="{{ form_data.vehicle_no }}" required>
                                <small class="text-muted">e.g., KA28AB2222</small>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Driver License Number</label>
                                        <input type="text" name="dl_no" class="form-control" 
                                               value="{{ form_data.dl_no }}" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Driver Mobile Number</label>
                                        <input type="text" name="driver_mob_no" class="form-control" 
                                               value="{{ form_data.driver_mob_no }}" required>
                                    </div>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-save me-2"></i>Save Form Data
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Export/Import Configuration -->
        <div class="row">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="fas fa-exchange-alt me-2"></i>Configuration Backup</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Export Configuration</h6>
                                <p class="text-muted">Download current configuration as JSON file</p>
                                <button id="export-config-btn" class="btn btn-outline-primary">
                                    <i class="fas fa-download me-2"></i>Export Config
                                </button>
                            </div>
                            <div class="col-md-6">
                                <h6>Import Configuration</h6>
                                <p class="text-muted">Upload and restore configuration from JSON file</p>
                                <input type="file" id="import-config-file" class="form-control mb-2" accept=".json">
                                <button id="import-config-btn" class="btn btn-outline-success" disabled>
                                    <i class="fas fa-upload me-2"></i>Import Config
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Information -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>System Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <strong>Application Version:</strong><br>
                                <span class="text-muted">v1.0.0</span>
                            </div>
                            <div class="col-md-4">
                                <strong>Target Website:</strong><br>
                                <span class="text-muted">kpcl-ams.com</span>
                            </div>
                            <div class="col-md-4">
                                <strong>Automation Type:</strong><br>
                                <span class="text-muted">Selenium WebDriver</span>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <strong>Features:</strong>
                                <ul class="list-unstyled mt-2">
                                    <li><i class="fas fa-check text-success me-2"></i>Automated login with OTP</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Dynamic data extraction</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Retry mechanism</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Real-time monitoring</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <strong>Security:</strong>
                                <ul class="list-unstyled mt-2">
                                    <li><i class="fas fa-check text-success me-2"></i>Local storage only</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Session validation</li>
                                    <li><i class="fas fa-check text-success me-2"></i>CSRF token handling</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Screenshot logging</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="notification-toast" class="toast" role="alert">
            <div class="toast-header">
                <strong class="me-auto">KPCL Automation</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/config.js') }}"></script>
</body>
</html>
